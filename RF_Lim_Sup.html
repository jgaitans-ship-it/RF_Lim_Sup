<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Julio César Gaitán Silva">

<title>RF_Lim_Sup</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="RF_Lim_Sup_files/libs/clipboard/clipboard.min.js"></script>
<script src="RF_Lim_Sup_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="RF_Lim_Sup_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="RF_Lim_Sup_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="RF_Lim_Sup_files/libs/quarto-html/popper.min.js"></script>
<script src="RF_Lim_Sup_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="RF_Lim_Sup_files/libs/quarto-html/anchor.min.js"></script>
<link href="RF_Lim_Sup_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="RF_Lim_Sup_files/libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="RF_Lim_Sup_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="RF_Lim_Sup_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="RF_Lim_Sup_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">RF_Lim_Sup</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Julio César Gaitán Silva </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="cargar-librerías" class="level1">
<h1>1. Cargar librerías</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>terra 1.8.80</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)       <span class="co"># Para trabajar con datos raster</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: sp</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)           <span class="co"># Para manipulación de datos espaciales</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.13.1, GDAL 3.11.4, PROJ 9.7.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)     <span class="co"># Para manejar archivos Excel</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)    <span class="co"># Conjunto de paquetes para manipulación de datos\library(DataExplorer) # Exploración de datos</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.6
✔ forcats   1.0.1     ✔ stringr   1.6.0
✔ ggplot2   4.0.1     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.2.0     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ tidyr::extract() masks raster::extract(), terra::extract()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
✖ dplyr::select()  masks raster::select()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)        <span class="co"># Visualización de mapas\library(ithir)       # Modelado de suelos</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aqp)         <span class="co"># Análisis de perfiles de suelo</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is aqp 2.2-1

Adjuntando el paquete: 'aqp'

The following objects are masked from 'package:dplyr':

    combine, slice

The following objects are masked from 'package:raster':

    coordinates, metadata, metadata&lt;-, proj4string

The following objects are masked from 'package:sp':

    coordinates, coordinates&lt;-, proj4string, proj4string&lt;-</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="carpeta-donde-están-todos-los-rásters-ya-procesados" class="level1">
<h1>2. Carpeta donde están TODOS los rásters ya procesados</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ruta <span class="ot">&lt;-</span> <span class="st">"D:/Meta_vichada/aligned/"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>rasters_sel <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Aspect.tif",</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"C.O.tif"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CI.tif"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Convergence_Index.tif",</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Hillshade.tif",</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"HH.tif",</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"HV.tif"</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"LS_Factor.tif"</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MCARI.tif"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"NDTI.tif"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Plan_Curvature.tif",</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Precipitación.tif",</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Profile_Curvature.tif",</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Relative_Slope_Position.tif"</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Suelos_.tif"</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Media_.tif",</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Topographic_Wetness_Index.tif"</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Total_Catchment_Area.tif",</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Valley_Depth.tif"</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"GNDVI.tif",</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"BSI.tif",</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Channel_Network_Base_Level.tif",</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Channel_Network_Distance.tif",</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"DEM.tif",</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"EVI.tif",</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NBR.tif",</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NDVI.tif",</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NDWI.tif",</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"SAVI.tif",</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Slope.tif"</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Maxima_.tif",</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Minima_.tif",</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="construir-rutas-completas-solo-de-los-seleccionados" class="level1">
<h1>3. Construir rutas completas SOLO de los seleccionados</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>files_sel <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ruta, rasters_sel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="verificar-cuáles-existen-control-de-errores" class="level1">
<h1>4. Verificar cuáles existen (control de errores)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>files_sel <span class="ot">&lt;-</span> files_sel[<span class="fu">file.exists</span>(files_sel)]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Si alguno falta, aquí lo ves</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">basename</span>(files_sel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "C.O.tif"                       "CI.tif"                       
 [3] "HV.tif"                        "LS_Factor.tif"                
 [5] "MCARI.tif"                     "NDTI.tif"                     
 [7] "Relative_Slope_Position.tif"   "Suelos_.tif"                  
 [9] "Topographic_Wetness_Index.tif" "Valley_Depth.tif"             </code></pre>
</div>
</div>
</section>
<section id="cargar-como-spatraster" class="level1">
<h1>5. Cargar como SpatRaster</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>raster <span class="ot">&lt;-</span> <span class="fu">rast</span>(files_sel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="verificación-rápida" class="level1">
<h1>6. Verificación rápida</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compareGeom</span>(raster, raster[[<span class="dv">1</span>]], <span class="at">stopOnError =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="visualización" class="level1">
<h1>7. Visualización</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(raster)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="RF_Lim_Sup_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="obtener-coordenadas-únicas" class="level1">
<h1>8. Obtener coordenadas únicas</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>SCHS <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"D:/MAESTRIA/Trabajo_final/SCHS.xlsx"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Coor <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Perfil_COD1=</span>SCHS<span class="sc">$</span>Perfil_COD1,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Latitud =</span> SCHS<span class="sc">$</span>Latitud,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Longitud =</span> SCHS<span class="sc">$</span>Longitud,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Lim_sup =</span> SCHS<span class="sc">$</span>lim_sup)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Lim_inf = SCHS$lim_inf )</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(Coor)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Coor)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   225 obs. of  4 variables:
 $ Perfil_COD1: chr  "AR-011" "AR-021" "AR-026" "AR-043" ...
 $ Latitud    : num  3.36 3.5 3.46 3.38 4.5 ...
 $ Longitud   : num  -73.7 -74 -73.9 -73.7 -71.3 ...
 $ Lim_sup    : num  13.8 13.5 11.7 16.8 27.6 ...</code></pre>
</div>
</div>
</section>
<section id="convertir-a-formato-espacial-sf" class="level1">
<h1>9. Convertir a formato espacial (sf)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data_final_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="at">x =</span> Coor,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Longitud"</span>, <span class="st">"Latitud"</span>),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(data_final_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="visualizar-los-puntos-sobre-el-modelo-de-elevación-dem" class="level1">
<h1>10. Visualizar los puntos sobre el modelo de elevación (DEM)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(raster<span class="sc">$</span>Topographic_Wetness_Index)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(data_final_sf), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col=</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="RF_Lim_Sup_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualización-con-tmap" class="level1">
<h1>11. Visualización con tmap</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(raster<span class="sc">$</span>Topographic_Wetness_Index) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#CCCCCC"</span>, <span class="st">"#999999"</span>, <span class="st">"#666666"</span>, <span class="st">"#333333"</span>, <span class="st">"#000000"</span>)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(data_final_sf) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="st">"Lim_sup"</span>, <span class="at">palette =</span> <span class="st">"-RdYlBu"</span>, <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="st">"Mapa Lim_Sup cm"</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>() <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── tmap v3 code detected ───────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[v3-&gt;v4] `tm_tm_raster()`: migrate the argument(s) related to the scale of the
visual variable `col` namely 'palette' (rename to 'values') to col.scale =
tm_scale(&lt;HERE&gt;).
[v3-&gt;v4] `tm_tm_dots()`: migrate the argument(s) related to the scale of the
visual variable `fill` namely 'palette' (rename to 'values') to fill.scale =
tm_scale(&lt;HERE&gt;).
[v3-&gt;v4] `tm_layout()`: use `tm_title()` instead of `tm_layout(title = )`
! `tm_scale_bar()` is deprecated. Please use `tm_scalebar()` instead.
SpatRaster object downsampled to 2505 by 3993 cells.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="RF_Lim_Sup_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extraer-valores-raster-en-los-puntos-espaciales" class="level1">
<h1>12. Extraer valores raster en los puntos espaciales</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>extraccion <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(raster, <span class="fu">vect</span>(data_final_sf))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>data_sf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data_final_sf, extraccion[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span> (data_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="modelamiento" class="level1">
<h1>13. Modelamiento</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)        <span class="co"># Para ajuste de modelos</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'caret'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># Random Forest</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'randomForest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:aqp':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'ranger'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:randomForest':

    importance</code></pre>
</div>
</div>
</section>
<section id="resumen-de-los-datos-espaciales" class="level1">
<h1>14. Resumen de los datos espaciales</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Perfil_COD1           Lim_sup             C.O              CI        
 Length:225         Min.   :  3.625   Min.   :16.10   Min.   :0.1548  
 Class :character   1st Qu.: 11.374   1st Qu.:22.62   1st Qu.:0.5939  
 Mode  :character   Median : 14.841   Median :25.25   Median :0.7866  
                    Mean   : 19.103   Mean   :26.68   Mean   :0.9230  
                    3rd Qu.: 22.794   3rd Qu.:31.79   3rd Qu.:1.1672  
                    Max.   :115.774   Max.   :70.25   Max.   :2.3920  
       HV            LS_Factor             MCARI               NDTI        
 Min.   :-31.215   Min.   : 0.000109   Min.   :0.008303   Min.   :0.02205  
 1st Qu.:-23.700   1st Qu.: 0.187458   1st Qu.:0.048938   1st Qu.:0.16568  
 Median :-19.620   Median : 0.400085   Median :0.062091   Median :0.18370  
 Mean   :-19.575   Mean   : 1.368948   Mean   :0.063347   Mean   :0.17972  
 3rd Qu.:-15.374   3rd Qu.: 1.022462   3rd Qu.:0.077835   3rd Qu.:0.20163  
 Max.   : -8.273   Max.   :42.507114   Max.   :0.133466   Max.   :0.23763  
 Relative_Slope_Position    Suelos_      Topographic_Wetness_Index
 Min.   :0.000000        Min.   : 0.00   Min.   : 5.026           
 1st Qu.:0.001673        1st Qu.: 4.00   1st Qu.: 7.364           
 Median :0.008315        Median :17.00   Median : 8.340           
 Mean   :0.037083        Mean   :23.09   Mean   : 9.751           
 3rd Qu.:0.033621        3rd Qu.:40.00   3rd Qu.:10.840           
 Max.   :0.781887        Max.   :57.00   Max.   :25.343           
  Valley_Depth              geometry  
 Min.   :  4.941   POINT        :225  
 1st Qu.:121.764   epsg:4326    :  0  
 Median :195.087   +proj=long...:  0  
 Mean   :237.062                      
 3rd Qu.:304.421                      
 Max.   :770.234                      </code></pre>
</div>
</div>
</section>
<section id="convertir-a-dataframe-para-modelado-no-se-tiene-en-cuenta-la-columna-id" class="level1">
<h1>15. Convertir a dataframe para modelado, no se tiene en cuenta la columna ID</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>data_sf_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(data_sf)[<span class="dv">2</span><span class="sc">:</span><span class="dv">12</span>]</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>data_sf_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data_sf_df)<span class="co">#</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_sf_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Lim_sup             C.O              CI               HV         
 Min.   :  3.625   Min.   :16.10   Min.   :0.1548   Min.   :-31.215  
 1st Qu.: 11.374   1st Qu.:22.62   1st Qu.:0.5939   1st Qu.:-23.700  
 Median : 14.841   Median :25.25   Median :0.7866   Median :-19.620  
 Mean   : 19.103   Mean   :26.68   Mean   :0.9230   Mean   :-19.575  
 3rd Qu.: 22.794   3rd Qu.:31.79   3rd Qu.:1.1672   3rd Qu.:-15.374  
 Max.   :115.774   Max.   :70.25   Max.   :2.3920   Max.   : -8.273  
   LS_Factor             MCARI               NDTI        
 Min.   : 0.000109   Min.   :0.008303   Min.   :0.02205  
 1st Qu.: 0.187458   1st Qu.:0.048938   1st Qu.:0.16568  
 Median : 0.400085   Median :0.062091   Median :0.18370  
 Mean   : 1.368948   Mean   :0.063347   Mean   :0.17972  
 3rd Qu.: 1.022462   3rd Qu.:0.077835   3rd Qu.:0.20163  
 Max.   :42.507114   Max.   :0.133466   Max.   :0.23763  
 Relative_Slope_Position    Suelos_      Topographic_Wetness_Index
 Min.   :0.000000        Min.   : 0.00   Min.   : 5.026           
 1st Qu.:0.001673        1st Qu.: 4.00   1st Qu.: 7.364           
 Median :0.008315        Median :17.00   Median : 8.340           
 Mean   :0.037083        Mean   :23.09   Mean   : 9.751           
 3rd Qu.:0.033621        3rd Qu.:40.00   3rd Qu.:10.840           
 Max.   :0.781887        Max.   :57.00   Max.   :25.343           
  Valley_Depth    
 Min.   :  4.941  
 1st Qu.:121.764  
 Median :195.087  
 Mean   :237.062  
 3rd Qu.:304.421  
 Max.   :770.234  </code></pre>
</div>
</div>
</section>
<section id="seleccionar-la-mejor-semilla-para-modelo-random-forest" class="level1">
<h1>16. Seleccionar la mejor semilla para Modelo Random Forest</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(progress)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>resultados_Lim_Sup <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="fu">integer</span>(),</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ntree =</span> <span class="fu">integer</span>(),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry =</span> <span class="fu">integer</span>(),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_train =</span> <span class="fu">numeric</span>(),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_train =</span> <span class="fu">numeric</span>(),</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_test =</span> <span class="fu">numeric</span>(),</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_test =</span> <span class="fu">numeric</span>()</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>best_rmse  <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>best_seed  <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>) {</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(s)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Dividir los datos en conjunto de entrenamiento y prueba para Lim_Sup</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> data_sf_df<span class="sc">$</span>Lim_sup,</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="fl">0.70</span>,</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">list =</span> <span class="cn">FALSE</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  train <span class="ot">&lt;-</span> data_sf_df[index, ]</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>  test  <span class="ot">&lt;-</span> data_sf_df[<span class="sc">-</span>index, ]</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuración de Hiperparámetros</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>  train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"cv"</span>,</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">allowParallel =</span> <span class="cn">TRUE</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid de hiperparámetros para Random Forest</span></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>  GRID_RF <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtry =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>)</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>  best_rmse_seed <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>  best_model_seed <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>  best_ntree_seed <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (nt <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">500</span>)) {</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Entranimiento del modelo Random Forest con grid</span></span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>    modelo <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>      Lim_sup <span class="sc">~</span> .,</span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> train,</span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">trControl =</span> train_control,</span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> GRID_RF,</span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">ntree =</span> nt</span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>    pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, test)</span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>    RMSE_test <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred, test<span class="sc">$</span>Lim_sup)</span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (RMSE_test <span class="sc">&lt;</span> best_rmse_seed) {</span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a>      best_rmse_seed  <span class="ot">&lt;-</span> RMSE_test</span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a>      best_model_seed <span class="ot">&lt;-</span> modelo</span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>      best_ntree_seed <span class="ot">&lt;-</span> nt</span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a>  best_mtry <span class="ot">&lt;-</span> best_model_seed<span class="sc">$</span>bestTune<span class="sc">$</span>mtry</span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>  train_metrics <span class="ot">&lt;-</span> best_model_seed<span class="sc">$</span>results[</span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>    best_model_seed<span class="sc">$</span>results<span class="sc">$</span>mtry <span class="sc">==</span> best_mtry, ]</span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a>  RMSE_train <span class="ot">&lt;-</span> train_metrics<span class="sc">$</span>RMSE</span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>  R2_train   <span class="ot">&lt;-</span> train_metrics<span class="sc">$</span>Rsquared</span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_model_seed, test)</span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a>  RMSE_test <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred, test<span class="sc">$</span>Lim_sup)</span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a>  R2_test   <span class="ot">&lt;-</span> <span class="fu">cor</span>(pred, test<span class="sc">$</span>Lim_sup)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a>  resultados_Lim_Sup <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a>    resultados_Lim_Sup,</span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> s,</span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">ntree =</span> best_ntree_seed,</span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">mtry =</span> best_mtry,</span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE_train =</span> RMSE_train,</span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">R2_train =</span> R2_train,</span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE_test =</span> RMSE_test,</span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">R2_test =</span> R2_test</span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-99"><a href="#cb48-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-100"><a href="#cb48-100" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (RMSE_test <span class="sc">&lt;</span> best_rmse) {</span>
<span id="cb48-101"><a href="#cb48-101" aria-hidden="true" tabindex="-1"></a>    best_rmse  <span class="ot">&lt;-</span> RMSE_test</span>
<span id="cb48-102"><a href="#cb48-102" aria-hidden="true" tabindex="-1"></a>    best_model <span class="ot">&lt;-</span> best_model_seed</span>
<span id="cb48-103"><a href="#cb48-103" aria-hidden="true" tabindex="-1"></a>    best_seed  <span class="ot">&lt;-</span> s</span>
<span id="cb48-104"><a href="#cb48-104" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-105"><a href="#cb48-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-106"><a href="#cb48-106" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-107"><a href="#cb48-107" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb48-108"><a href="#cb48-108" aria-hidden="true" tabindex="-1"></a>best_seed</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 178</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>best_rmse</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.609205</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>best_model</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest 

160 samples
 10 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 144, 144, 144, 144, 144, 144, ... 
Resampling results across tuning parameters:

  mtry  RMSE      Rsquared    MAE      
  2     14.47621  0.09064205   9.768687
  3     14.61704  0.08807019   9.827246
  4     14.70448  0.08417192   9.938765
  5     14.82894  0.09624184  10.144766
  6     14.89348  0.09421531  10.042482
  7     15.04851  0.10632456  10.325851
  8     14.91138  0.11411056  10.160927
  9     15.18342  0.08463681  10.379246

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was mtry = 2.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resultados_Lim_Sup)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    seed ntree mtry RMSE_train   R2_train RMSE_test      R2_test
1      1    50    2  11.533795 0.12432684 14.952500 4.903279e-02
2      2   100    2  14.296301 0.09650240  8.477246 1.062868e-01
3      3   100    2  13.615823 0.09279729  8.916866 9.844618e-02
4      4   100    2  11.355998 0.15784651 14.666922 6.722906e-02
5      5    50    2  11.702437 0.11974547 14.060266 1.454977e-01
6      6   150    2  10.702042 0.18710185 16.547978 1.181616e-02
7      7   200    2  13.383408 0.12154035  9.388895 1.587779e-01
8      8   500    2  11.483282 0.17062081 14.651215 6.333804e-02
9      9    50    2  11.729771 0.10712338 15.432758 5.185701e-02
10    10    50    2  12.847527 0.11786232 10.589546 7.468880e-02
11    11   200    2  13.142865 0.12843453 10.908213 8.970167e-02
12    12   150    2  11.558653 0.12507786 14.194257 1.343211e-01
13    13   150    2  13.566156 0.11815636  8.845610 1.669622e-01
14    14    50    2  11.665706 0.09799727 14.312720 2.017246e-01
15    15   300    2  11.623115 0.15616661 14.509520 6.035202e-02
16    16   300    2  12.260296 0.12598930 12.154064 3.568540e-02
17    17   300    2  11.552033 0.16355826 11.904874 7.627964e-02
18    18    50    2  11.688659 0.13715953 14.976767 2.733228e-02
19    19   150    2  12.930669 0.16074801 11.573754 5.280107e-02
20    20   500    2  13.046029 0.12179445 10.538757 1.633908e-01
21    21   200    2   9.253460 0.17766469 18.633915 1.042640e-01
22    22   300    2  13.032069 0.20854431 10.195102 8.803294e-02
23    23   300    2  12.324201 0.15740140 10.194385 1.213940e-01
24    24    50    2  12.268900 0.14574661 10.726440 1.586313e-01
25    25   500    2  12.313124 0.06837255 11.584416 1.881573e-01
26    26   200    2  13.991979 0.10510656  8.845807 5.401308e-02
27    27   150    2  11.793123 0.15230911 14.089332 4.723716e-02
28    28   300    2  11.336850 0.06605615 14.314793 2.364331e-01
29    29   100    2  11.006876 0.19673083 15.266893 1.897541e-02
30    30    50    5  11.776467 0.15491489 14.735450 5.641462e-02
31    31   100    2  11.073581 0.12025101 15.851616 2.995838e-02
32    32    50    2  12.561375 0.11895858 12.328185 4.820277e-02
33    33   300    2  10.383708 0.15978488 16.319481 6.536325e-02
34    34   200    2  12.956204 0.14800636  9.089629 1.089711e-01
35    35    50    2  10.715223 0.17251973 15.112203 1.062113e-01
36    36   300    2  12.013587 0.17161570 13.035471 2.877199e-02
37    37   100    2   9.394529 0.16657931 18.190593 1.134109e-01
38    38   100    2  12.908825 0.20185251  9.929561 8.999294e-02
39    39   150    2  11.831809 0.23288469 14.488233 4.807644e-04
40    40   150    2  13.572733 0.10444139  9.691030 9.446072e-02
41    41   100    2  11.990405 0.18843037 13.716578 8.186941e-03
42    42   300    2  12.102808 0.17938038 12.565081 1.524874e-02
43    43    50    2  13.090826 0.07753614 11.777684 1.265382e-01
44    44    50    2  13.782500 0.10946469  9.929912 1.501732e-01
45    45   500    2  12.363422 0.13946954 11.492222 5.334240e-02
46    46    50    2  11.357999 0.10824502 14.790431 1.472851e-01
47    47   200    2  11.970652 0.19047264 14.036103 5.238763e-02
48    48   200    2  11.904200 0.10740775 14.271932 1.529305e-01
49    49   500    2  13.916620 0.09705371  9.554176 7.717739e-02
50    50   200    2  11.069241 0.12083492 16.206430 2.934517e-02
51    51    50    2  10.452131 0.22388598 15.441564 5.238529e-02
52    52   300    2  12.892377 0.15738445 10.641838 5.814903e-02
53    53   150    2  13.694373 0.11983520  8.931536 1.796292e-01
54    54   300    2  11.515222 0.11732174 14.864678 5.976602e-02
55    55   100    2  13.386069 0.18945204  9.387499 3.308392e-02
56    56   500    2  13.508333 0.11287615 10.562342 6.240077e-02
57    57   500    2  11.153831 0.14642964 14.568983 6.117618e-02
58    58   500    2  11.278306 0.12662167 15.118428 1.592752e-01
59    59   150    2  10.819747 0.16927118 15.666105 4.620052e-02
60    60   100    2  13.588889 0.07250209  9.735148 8.909168e-02
61    61   100    2   9.510242 0.13409776 18.621258 5.592319e-02
62    62   200    2  11.837911 0.15448285 15.104129 7.680891e-03
63    63    50    2  11.530610 0.09902167 15.400001 1.711092e-01
64    64   500    2  13.619563 0.13373803  8.950368 2.203558e-01
65    65   100    2  11.760909 0.11051689 14.584174 7.393712e-02
66    66   300    2  13.370430 0.11929289  9.681313 7.454512e-02
67    67    50    3  13.142254 0.09908697 11.234760 2.779197e-02
68    68    50    3  13.007681 0.16812701 10.604781 1.564339e-01
69    69   100    2  11.814466 0.14035718 14.832860 4.705694e-02
70    70   100    2  11.415729 0.22358556 14.371306 1.161142e-02
71    71   100    2  11.539793 0.15423551 14.688393 2.458575e-02
72    72   200    2  11.014495 0.16915405 15.922610 2.923827e-02
73    73   100    2  10.916892 0.09906921 15.162926 1.165274e-01
74    74   100    2  11.047843 0.19652438 14.677938 3.433572e-02
75    75   100    2  12.833540 0.12990524 11.855331 1.044128e-01
76    76   300    2  13.238524 0.12750092 10.376990 8.793103e-02
77    77   500    2  13.189490 0.13118451  9.705817 1.222210e-01
78    78   150    2  11.331463 0.17629280 14.474765 6.944066e-02
79    79   200    2  13.902312 0.16910275  9.089366 6.971227e-02
80    80   300    2  12.993458 0.16977871 11.450252 4.143952e-02
81    81   150    2  12.913902 0.18330127 11.554879 4.812588e-02
82    82   150    2   8.557860 0.15986061 19.499344 1.514034e-01
83    83   100    2  10.943881 0.11049610 15.563861 1.789712e-01
84    84   100    2  11.778360 0.12958270 14.600333 4.912782e-02
85    85    50    2  13.471752 0.06731599  9.487728 1.900595e-01
86    86   200    2  12.925901 0.12195525 10.597156 1.956950e-01
87    87   200    2  13.618804 0.11650584 10.649756 8.267564e-02
88    88   100    2  11.603425 0.15894332 15.584125 1.194473e-02
89    89   500    2  12.675119 0.13329493 10.864506 4.924975e-02
90    90    50    2  11.574614 0.16265847 14.023788 3.597495e-02
91    91   200    2  13.339999 0.11188918 10.065899 4.620503e-02
92    92   300    2  13.420420 0.21096496  8.675651 6.529460e-02
93    93   100    2  13.489265 0.09899987  8.931080 6.244693e-02
94    94    50    2  11.917814 0.07621012 13.989732 1.851373e-01
95    95   200    2  11.098122 0.11932605 15.336252 1.158206e-01
96    96    50    2  12.777012 0.10524248 10.352151 6.715103e-02
97    97    50    2  12.016630 0.06486537 14.651455 1.659370e-01
98    98   300    2  13.133018 0.11516322  9.097432 2.634166e-01
99    99   500    2  11.581185 0.12824289 14.547109 1.296785e-01
100  100    50    2  13.745112 0.11667690 10.461361 3.702722e-02
101  101    50    2  12.455438 0.19610436 12.267570 9.262865e-04
102  102   100    2  11.405248 0.20899609 14.419189 5.186969e-02
103  103   150    2  10.954799 0.09862236 15.584162 1.262179e-01
104  104   500    2  13.662890 0.05946761  9.823145 1.589835e-01
105  105   150    2  11.565735 0.14080005 14.703297 5.809126e-02
106  106    50    2  11.359485 0.15656328 14.614543 6.696869e-02
107  107   200    2  11.274966 0.16924504 14.879512 8.440645e-02
108  108    50    2   9.850234 0.16035646 18.061177 6.907072e-02
109  109    50    2  12.280621 0.14287372 11.812025 2.812754e-02
110  110   100    2  13.690911 0.08503254 10.793701 9.508993e-02
111  111   500    2  12.024393 0.18067520 12.648352 7.621529e-03
112  112   500    2  13.926334 0.09066671  8.900707 1.025540e-01
113  113   100    2   9.776787 0.16448785 18.401369 6.843120e-02
114  114   200    2  13.170842 0.14596091  9.679860 7.720083e-02
115  115   200    2  12.194790 0.08561852 14.266164 9.073322e-02
116  116    50    2  10.311782 0.10868564 16.382414 1.301861e-01
117  117   200    2  11.167331 0.16102910 14.996899 7.223073e-02
118  118   300    2  11.833865 0.08186524 14.335760 6.422480e-02
119  119   300    2  12.660435 0.17952709 11.889781 3.371467e-02
120  120   100    2  13.389383 0.13358836  9.674477 1.441915e-01
121  121   100    2  11.322580 0.12744169 15.312012 7.108303e-02
122  122   150    2  11.627867 0.13277138 13.965012 1.603977e-01
123  123   200    2  13.434897 0.11724467  9.696833 1.295599e-01
124  124   200    2  11.486189 0.20650810 14.177581 2.053632e-02
125  125   200    2  12.810596 0.12466081 10.819761 1.487828e-01
126  126   500    2  13.165085 0.15427485  9.956558 1.278284e-01
127  127   150    2  11.677881 0.15891037 14.677703 2.873826e-02
128  128    50    2  11.354637 0.17209116 15.043098 4.544821e-02
129  129    50    2  13.816870 0.11414406  9.218904 6.826308e-02
130  130   200    2   9.821870 0.12320341 17.888797 8.350305e-02
131  131   300    2  11.314664 0.08476858 15.034233 1.543070e-01
132  132   100    3   9.833131 0.18869605 17.018267 9.807337e-02
133  133   150    2  11.694920 0.15843783 14.376653 1.021342e-01
134  134   300    2  11.655481 0.15999432 15.433750 4.969816e-04
135  135    50    2  13.658174 0.09534619  9.464257 6.939549e-02
136  136   200    2  12.464075 0.09735475 12.430793 6.615186e-02
137  137   150    2  13.868111 0.08192069  9.438865 8.928389e-02
138  138    50    2  11.839895 0.16221917 13.479782 5.823142e-02
139  139   100    2  12.484425 0.25089986 10.849196 4.151677e-02
140  140   100    2  11.625169 0.14914714 14.490703 6.780195e-02
141  141   200    2  12.361046 0.06728197 13.616001 1.379042e-01
142  142   150    2  11.415893 0.11930930 15.518740 1.050431e-01
143  143   300    2  13.004022 0.13460499 10.640949 1.000593e-01
144  144   150    2   8.950071 0.21410073 19.154271 7.030638e-02
145  145   300    2  12.613162 0.11546042 10.016436 1.161321e-01
146  146   500    2  11.738668 0.18366659 13.632522 2.309418e-02
147  147   500    2  10.180204 0.10153688 16.291254 1.613149e-01
148  148   200    2  11.892198 0.19086661 14.691097 3.310457e-03
149  149   500    2  11.064666 0.08590987 15.147722 1.650879e-01
150  150   100    2  11.651883 0.11935355 14.432867 1.419061e-01
151  151    50    2  11.632615 0.11987945 14.389907 6.351710e-02
152  152   300    2  11.914616 0.09562586 14.349549 7.495280e-02
153  153    50    2  13.219190 0.12124598 10.297207 1.680210e-01
154  154   150    2  11.320246 0.15428527 14.814327 8.376347e-02
155  155    50    2  11.903798 0.17934289 14.073977 2.307552e-02
156  156   200    2  12.578869 0.15973197 11.293547 5.648449e-02
157  157   500    2  11.192860 0.13766839 14.590468 1.215300e-01
158  158   100    2  10.834445 0.13494377 15.185853 6.031516e-02
159  159   300    2  10.193087 0.13517397 17.763243 7.738739e-02
160  160    50    3  10.734103 0.16928201 16.030574 8.454492e-02
161  161   500    2  11.367148 0.12399845 16.055871 1.933977e-02
162  162   300    2  13.467012 0.16101732  8.712208 1.081551e-01
163  163   200    2  13.595751 0.16208219  9.739495 5.597639e-02
164  164   100    2  13.379845 0.10237996  9.420090 1.300417e-01
165  165   500    2  13.098025 0.10000858 10.657950 7.076801e-02
166  166   500    2  12.860683 0.14662606  9.819515 1.301173e-01
167  167   100    2  14.143159 0.13247704  8.408842 1.222686e-01
168  168   200    2  10.294430 0.13312027 16.475259 7.881778e-02
169  169   500    2  11.018105 0.12541407 15.454581 1.208452e-01
170  170   500    2  12.958771 0.11630205  9.859744 1.806295e-01
171  171   200    2  13.603843 0.13073803 10.203952 8.870899e-02
172  172    50    3   9.809821 0.23062337 18.179058 3.626410e-02
173  173   300    2  12.856221 0.14137903 10.324650 9.560457e-02
174  174   100    2  14.092324 0.10080266  8.583325 6.617533e-02
175  175   200    2   9.136424 0.19688562 19.000211 6.144747e-02
176  176    50    2  11.667386 0.11343771 14.390433 4.579655e-02
177  177   300    2  11.769687 0.08626885 14.624382 7.512529e-02
178  178   150    2  14.476209 0.09064205  7.609205 3.037925e-01
179  179   500    2  10.408448 0.14408826 17.578147 5.558963e-02
180  180   500    2  13.204242 0.13794918 11.015851 7.247252e-02
181  181   200    2  11.279396 0.10863507 14.960690 4.468296e-02
182  182   100    2  12.632201 0.12498630 11.052248 6.025899e-02
183  183   150    2  13.634752 0.07721294 10.063111 1.003624e-01
184  184   150    2   9.504611 0.13572790 18.823857 6.928284e-02
185  185   300    2  11.622526 0.16097331 14.185207 1.312950e-01
186  186   100    2  13.388564 0.15822231  8.182512 1.206220e-01
187  187   300    2  11.567318 0.13583273 14.758023 3.276489e-02
188  188   500    2  13.290063 0.08141795  9.449359 1.919996e-01
189  189   150    2  10.691279 0.22092338 15.807177 4.624461e-02
190  190    50    2  11.560960 0.20446702 14.880865 1.864822e-02
191  191    50    2  12.064906 0.13201813 12.985949 7.009189e-02
192  192   200    2  10.937767 0.12729375 15.608980 1.069155e-01
193  193   150    2  12.748036 0.11505741 10.434670 1.121092e-01
194  194   200    2  11.659592 0.13426465 13.863544 5.220745e-02
195  195    50    2  12.623172 0.14972154 12.107001 3.958188e-02
196  196   150    2  13.337385 0.14110100 10.998142 4.997062e-02
197  197   500    2  12.857053 0.13790616 11.267115 6.257226e-02
198  198   100    2  13.155608 0.09134097  9.697685 1.605344e-01
199  199   100    2  13.367110 0.13438358 11.584557 6.362524e-02
200  200   500    2  12.658158 0.11964913 11.320843 6.185909e-02
201  201   150    2  12.833993 0.20271202 14.255497 2.247270e-02
202  202   100    2  11.935640 0.09687651 14.157944 9.512663e-02
203  203   200    2  13.490001 0.10880523  9.311142 1.477307e-01
204  204   500    2  10.702033 0.07923927 15.594081 1.380346e-01
205  205   200    2  11.385088 0.18355829 14.840659 1.578161e-02
206  206   500    2  13.560145 0.07051438  8.238684 1.153464e-01
207  207    50    3   9.184224 0.21906381 18.724659 5.413843e-02
208  208    50    2  11.801307 0.11343933 14.210306 9.438578e-02
209  209   200    2  13.287622 0.18778634 10.709987 1.702604e-02
210  210   500    2  12.755934 0.11415827 10.390236 1.101230e-01
211  211   100    2  10.531245 0.15256158 16.370354 3.896670e-02
212  212    50    2  11.082712 0.15655874 15.186991 1.190555e-01
213  213    50    3  12.256886 0.09295743 13.605719 1.307941e-01
214  214    50    2  12.951855 0.14388760 11.190153 3.094494e-02
215  215   100    2  12.412540 0.13849016 11.080450 2.784692e-02
216  216   200    2  11.153179 0.12534640 14.813233 1.270131e-01
217  217   200    2  13.816222 0.16780012  8.297630 8.011314e-02
218  218   150    2  13.549158 0.16474651  9.097363 1.086176e-01
219  219   500    2  13.451883 0.12089063 10.332914 4.426436e-02
220  220   500    2  13.359952 0.17164335 10.314819 3.961833e-02
221  221   150    2  13.225619 0.10978628 10.152848 6.072352e-02
222  222   200    2  13.465562 0.10512970 10.269311 1.385377e-01
223  223   500    2  12.753009 0.15106376 10.048008 1.076560e-01
224  224   200    2  13.057978 0.14550956  9.972791 1.275812e-01
225  225   150    2  13.412228 0.11354263  9.459499 2.174272e-01
226  226   150    2  11.478153 0.13336346 12.734795 5.647046e-02
227  227   200    2  11.551227 0.21566356 12.319067 2.000379e-02
228  228    50    2  12.832521 0.12950942 11.146454 7.857082e-02
229  229   500    2  11.482209 0.07054289 14.965279 2.007684e-01
230  230   300    2  13.407254 0.10667898 11.351120 5.674350e-02
231  231   150    2  10.521725 0.18420416 16.492987 4.759515e-02
232  232    50    2  13.264474 0.17047051 10.316413 6.613409e-02
233  233   150    2  12.186114 0.12935158 10.481691 1.420256e-01
234  234   100    2  11.070071 0.07103697 15.668798 1.524837e-01
235  235    50    2  11.675076 0.14538443 14.682802 6.522940e-02
236  236   100    2  13.700432 0.10825301  8.225471 1.697294e-01
237  237   100    2  13.628105 0.09416700  9.668460 1.375457e-01
238  238    50    2  13.584978 0.08316031  9.105818 2.424141e-01
239  239   200    2   8.647682 0.28877279 19.297686 7.854777e-02
240  240   100    3  10.970089 0.19198197 15.308495 2.819574e-02
241  241   100    2  11.165438 0.15534948 15.572469 3.096743e-02
242  242   200    2  11.277460 0.08891273 14.452141 1.610509e-01
243  243   300    2  10.366261 0.22093382 16.828550 3.194865e-02
244  244   500    2  12.680054 0.15893823 10.323088 1.071081e-01
245  245   150    2  11.563809 0.14165977 14.723053 1.038310e-01
246  246   200    2  11.420986 0.13783801 15.189159 2.823650e-02
247  247   500    2  13.600745 0.15831335  9.173213 8.708706e-02
248  248   200    2  13.045094 0.17129936 10.348989 4.619527e-02
249  249   150    2  13.146023 0.11499116 11.425485 8.747016e-02
250  250   150    2  12.863519 0.09549931 11.085707 1.637459e-01
251  251   100    2  10.936564 0.14838878 15.357254 1.093547e-01
252  252    50    2  10.898543 0.20135965 15.163983 5.992804e-02
253  253   100    3  10.885153 0.20473618 15.138651 4.480881e-02
254  254    50    2  12.802501 0.16918181 12.659243 3.013055e-02
255  255   300    2  13.875190 0.17318642  9.277404 1.393841e-01
256  256   150    2  13.364433 0.13510258  9.250655 1.153483e-01
257  257   300    2  13.327745 0.08530146 10.283602 7.124891e-02
258  258   200    2   9.939023 0.22116345 17.873173 1.033682e-01
259  259   100    2  11.791014 0.14495547 12.225202 8.925794e-02
260  260   200    2  11.385665 0.18851510 14.818065 2.149274e-02
261  261   500    2  13.296923 0.12551418  9.944212 1.526871e-01
262  262   150    2  12.366847 0.14280483 10.082932 1.832194e-01
263  263   100    3   9.204364 0.17826023 18.717705 7.248063e-02
264  264   500    2  12.972753 0.18823098 10.556560 8.115659e-02
265  265   200    2   8.944786 0.21910046 18.803322 3.933525e-02
266  266   500    2   9.458704 0.13787782 18.595566 6.499344e-02
267  267   200    2  14.112330 0.06751718  8.136096 1.875399e-01
268  268   100    2  11.561124 0.22309657 14.718926 1.687647e-02
269  269   200    2   9.443871 0.07356074 19.013381 1.566312e-01
270  270   150    2  13.679216 0.15831420  8.599094 1.359137e-01
271  271   500    2   9.181526 0.21079311 18.869952 3.989508e-02
272  272   100    2  12.640058 0.21191678  9.493747 1.328064e-03
273  273   100    3  11.823906 0.15378155 14.096220 1.140969e-01
274  274   300    2  13.826808 0.09172012  9.829004 6.713008e-02
275  275   100    2  12.660049 0.19186875 10.796391 4.306728e-02
276  276   200    2  10.650700 0.19689058 15.609114 3.798604e-02
277  277    50    2  13.426390 0.16011250 10.212031 4.605007e-02
278  278    50    3  13.324512 0.10867986  9.616922 1.114295e-01
279  279   500    2  11.506401 0.17747703 14.431478 1.069681e-01
280  280   200    2  13.470685 0.14009178 10.628240 3.546593e-02
281  281    50    2  13.570338 0.07642014  8.815340 1.686430e-01
282  282   300    2  12.756027 0.07341976 11.174794 1.074315e-01
283  283   200    2  11.967009 0.15494775 14.395315 2.850102e-02
284  284   200    2  13.838457 0.13776580  9.094154 1.247037e-01
285  285   200    2  12.421318 0.11188706 13.605864 5.213765e-02
286  286   100    2  11.886921 0.14724874 14.455082 5.839230e-02
287  287   500    2  13.126921 0.15190081 11.032249 5.963341e-02
288  288   200    2  12.435225 0.14041442 11.716207 1.243915e-01
289  289   300    2  11.798540 0.26211983 15.125950 2.335097e-04
290  290   100    2  12.956820 0.20113573 10.376992 4.652156e-02
291  291   150    2  11.576906 0.15608170 14.415740 5.179954e-02
292  292   200    2  13.289528 0.10016556  9.402298 2.015243e-01
293  293   200    2  13.645777 0.11749282 10.142824 3.241738e-02
294  294   200    2  12.359869 0.21545762 10.035364 3.796280e-02
295  295   500    2  10.175289 0.21940926 16.742452 1.592571e-02
296  296   100    2  10.971651 0.23947039 15.231540 3.192743e-03
297  297   200    2  12.794189 0.20525731  9.859052 5.288407e-02
298  298   100    2  10.915619 0.16544017 15.851661 4.544351e-02
299  299   150    2  11.269971 0.16923662 14.458408 1.205559e-01
300  300   100    2  10.736876 0.11231216 15.771157 1.512889e-01
301  301   500    2  12.939100 0.08629377 10.139383 1.529679e-01
302  302   200    2  13.498700 0.13414562 10.158584 6.132201e-02
303  303   100    2  12.773040 0.09544729  9.299437 2.210670e-01
304  304   100    2  11.738266 0.13528030 14.913073 2.524325e-02
305  305   300    2  11.884869 0.06292687 14.486841 1.454826e-01
306  306   200    2  11.660581 0.18490107 14.201780 1.425217e-03
307  307   300    2  12.429179 0.10898134 13.768193 2.282303e-02
308  308   150    2  12.060482 0.10979638 13.887979 7.929566e-02
309  309   200    2  10.509197 0.24676025 16.329233 1.948905e-02
310  310   150    2  13.438219 0.13077687  9.156182 1.010544e-01
311  311   200    2  10.914366 0.14382078 15.520330 7.301001e-02
312  312   200    2  11.441670 0.16252163 14.089645 6.271072e-02
313  313   300    2  13.511831 0.14162366  9.719283 1.003208e-01
314  314   300    2  11.126163 0.19343205 15.430083 6.341413e-03
315  315   300    2  14.060743 0.17823589  8.479524 1.270087e-01
316  316    50    2  11.977457 0.12179109 14.551156 4.534687e-02
317  317   300    2  13.808926 0.13118720  9.458238 2.775673e-02
318  318   100    2  13.467614 0.13879575 10.323131 1.110807e-01
319  319   500    2  11.366363 0.13490369 15.331023 9.756248e-02
320  320   300    2  12.822812 0.15215083  9.454979 1.034369e-01
321  321   150    2  13.104236 0.11760207  8.316590 1.385333e-01
322  322   300    2  12.448479 0.12392469 11.585201 1.136667e-01
323  323   300    2  13.323460 0.09874492 10.125495 1.387581e-01
324  324   100    2  11.253785 0.17067290 15.453495 8.545259e-02
325  325   150    2  12.653745 0.16569546 11.604897 4.420641e-02
326  326   150    2  12.961673 0.09147672 10.211414 1.198541e-01
327  327   500    2  11.983787 0.16535086 13.040264 2.256402e-02
328  328   500    2  10.070526 0.11148982 17.539437 5.527847e-02
329  329   150    2  13.410102 0.12931768 10.438052 5.512704e-02
330  330    50    2  11.885529 0.15689451 14.834574 4.162934e-02
331  331   300    2  11.483684 0.11731927 14.830319 8.807791e-02
332  332   100    2  13.762503 0.09426190  8.328643 2.276668e-01
333  333   500    2  13.544485 0.09671658  8.252856 2.952031e-01
334  334   150    2  13.289073 0.09671681 10.896603 1.229503e-01
335  335   300    2  11.924024 0.17310979 14.161253 4.252234e-02
336  336   150    2  12.558796 0.16610281 12.116535 6.462682e-02
337  337   500    2  10.236371 0.25392390 16.872979 9.977826e-03
338  338    50    2  11.260325 0.16990728 14.919974 5.734368e-02
339  339   150    2  11.801576 0.14192068 14.229298 5.812961e-02
340  340   200    2  12.709442 0.12182768 10.905835 6.883820e-02
341  341   500    2  13.343779 0.15880783  9.505856 7.789030e-02
342  342   300    2   9.313629 0.17850646 18.890580 3.541688e-02
343  343    50    2  14.276674 0.18245725  9.257028 2.176550e-02
344  344    50    2  11.538756 0.13006856 15.005100 7.264967e-02
345  345   100    2  10.494016 0.12026042 15.691784 1.713987e-01
346  346   300    2  13.029622 0.20814830  8.825925 5.989722e-02
347  347   150    2  10.643248 0.15746943 15.961096 7.170751e-02
348  348    50    2  14.027715 0.09919504  8.313423 6.565767e-02
349  349   500    2  13.870761 0.06690395  9.923901 7.292366e-02
350  350    50    2   9.896795 0.18067362 17.693386 6.525414e-02
351  351   100    2  12.450475 0.17080733 11.751204 2.544365e-02
352  352    50    2  13.024803 0.16806835  9.754574 6.501043e-02
353  353   150    2  12.398680 0.12612485 13.506104 8.031565e-03
354  354   200    2  11.327986 0.14043151 14.671361 1.478471e-01
355  355   150    2  13.535938 0.12359644  9.186036 1.074426e-01
356  356   300    2  13.692266 0.08305356 10.085979 1.140234e-01
357  357   150    3  11.599924 0.14757440 14.396250 1.313526e-01
358  358   100    2  13.592970 0.06539284 10.314782 1.673387e-01
359  359   500    2  13.151281 0.17570913 10.201396 3.160829e-02
360  360   200    2  12.658060 0.05602320 11.625268 1.676784e-01
361  361   500    2  13.622130 0.09922589  8.716166 1.228515e-01
362  362    50    2  12.679914 0.18423079 10.668923 3.422435e-02
363  363   100    2  13.886957 0.09405142  9.901226 1.299938e-01
364  364   300    2  11.848378 0.11563796 14.300951 1.143505e-01
365  365   100    2  13.004611 0.15619344 11.829939 4.311934e-02
366  366   300    2  13.072246 0.19955688 10.225878 8.044028e-02
367  367    50    2  12.616549 0.15588070 10.482975 9.130007e-02
368  368   500    2  11.747885 0.10172269 13.929054 1.201666e-01
369  369   150    2  13.136116 0.18526632 10.423561 1.033108e-01
370  370   100    2  10.829963 0.22480305 16.085579 1.718477e-02
371  371   200    2  12.806457 0.18323239 11.255433 5.484922e-02
372  372   100    2  11.709053 0.11643839 14.785873 8.081857e-02
373  373   200    2  11.251251 0.10134314 14.963878 1.207167e-01
374  374   100    3  11.591072 0.19539420 14.254156 1.220548e-01
375  375   150    2  12.777067 0.16493495 11.147008 3.296163e-02
376  376   100    2  11.150957 0.15117963 15.545528 4.338713e-02
377  377   300    2  12.101334 0.06149511 14.111267 1.261484e-01
378  378   150    2  10.965786 0.18419166 15.103858 1.636531e-02
379  379   300    2  12.617604 0.14482576 11.481657 1.440482e-01
380  380   200    2  13.682757 0.09120204  9.629419 5.127225e-02
381  381   200    2  12.035235 0.21605548 13.803488 4.880902e-02
382  382    50    2  11.536036 0.15435484 14.630626 3.859143e-02
383  383   150    2  12.406819 0.17081272 11.810572 1.067644e-01
384  384   100    2  12.818005 0.14877756  9.879150 1.208632e-01
385  385   200    2  13.531205 0.09886922  9.852717 1.524387e-01
386  386   150    2  13.272663 0.15871260  9.175706 1.263296e-01
387  387   500    2  13.383939 0.14071190 10.326455 9.660757e-02
388  388    50    2  11.250881 0.25849972 14.951284 5.079191e-02
389  389    50    2  13.165022 0.14848621 10.147162 1.323065e-01
390  390   300    2  11.494737 0.13366542 14.530061 6.355655e-02
391  391   150    2  10.559880 0.16421746 15.927976 8.622361e-02
392  392   200    2  11.293150 0.16186274 14.598443 9.344453e-02
393  393   200    2  13.587583 0.13791203  9.539421 1.153959e-01
394  394   500    2  12.011837 0.15817726 13.971848 1.339024e-02
395  395   300    2  13.500367 0.08821255  9.300059 1.176242e-01
396  396    50    2  13.337285 0.07857451  9.293883 2.099952e-01
397  397   500    2  11.541264 0.16726116 14.251947 8.354114e-02
398  398   200    2  10.869168 0.17458000 15.530102 4.796061e-02
399  399    50    2  10.495281 0.16051323 15.432182 1.004692e-01
400  400    50    5  12.050993 0.13887137 14.445935 3.180914e-02
401  401   200    2  11.161993 0.23116409 14.907505 1.079495e-02
402  402   150    2  11.471999 0.13458135 14.906189 1.029869e-01
403  403   150    2  12.346015 0.12805706 13.478600 5.632585e-02
404  404    50    2  10.442189 0.09980821 17.638325 8.520026e-02
405  405    50    2  12.442498 0.16128363 11.783224 1.229854e-01
406  406    50    2  11.017624 0.13356672 15.213477 8.589214e-02
407  407    50    3  13.782639 0.17680260 10.449087 1.340632e-02
408  408   200    2  13.742292 0.09067631  9.375231 2.165581e-01
409  409    50    2  12.152937 0.20510739 13.785989 1.935734e-05
410  410   300    2  12.799500 0.11170024  9.403474 1.685517e-01
411  411   150    2  11.440995 0.15246833 13.670953 1.011390e-01
412  412   300    2  11.555597 0.08761795 14.377862 2.433017e-01
413  413   200    2  13.484644 0.09715596  9.875694 5.055904e-02
414  414   300    2  11.511793 0.15159964 14.296981 7.774229e-02
415  415   300    2  12.913697 0.11450217 10.264750 1.545596e-01
416  416   150    2  11.381636 0.17899912 14.711499 6.963556e-02
417  417   150    2  11.081716 0.11108150 16.139088 6.052801e-02
418  418   100    2  11.173636 0.17008808 15.766825 2.537578e-02
419  419   200    2  10.379009 0.14578553 16.189192 5.264207e-02
420  420   150    2  11.222449 0.13774147 14.643633 1.003145e-01
421  421   200    2  10.295012 0.13993127 16.545431 1.258123e-01
422  422   200    2  11.430103 0.15993240 14.411151 1.944060e-02
423  423   300    2  13.037428 0.18534906 10.117309 1.687362e-01
424  424   150    2  11.474444 0.18405965 14.017557 6.818263e-02
425  425   300    2   9.567235 0.17465600 18.230882 7.749159e-02
426  426   100    2  11.028833 0.16756865 16.171786 1.021703e-02
427  427    50    2  11.334101 0.14030244 15.176949 1.855873e-01
428  428   200    2  11.733830 0.11418431 14.358358 7.692756e-02
429  429   200    2  13.272644 0.13923826 11.087617 3.396534e-02
430  430   500    2  10.106734 0.18375326 17.839292 6.364378e-02
431  431   300    2  11.311706 0.16075820 14.966646 6.385520e-02
432  432   200    2  12.563035 0.14439355 11.658340 5.400057e-02
433  433   300    2  12.543488 0.14668551 11.445129 6.899657e-02
434  434   200    2  14.029394 0.08680721 10.239076 9.490915e-02
435  435   500    2  12.604405 0.12650143 11.416817 3.483628e-02
436  436   150    2  13.432102 0.11323288  8.366308 1.986205e-01
437  437    50    3  11.484967 0.10610259 14.485665 1.337052e-01
438  438   100    2  10.842963 0.17850015 15.478408 1.135608e-02
439  439   500    2   9.629908 0.22496960 17.858823 6.083076e-02
440  440   150    2  10.038867 0.22072895 17.953169 2.859187e-02
441  441   150    2  12.307952 0.12084282 13.659923 1.940730e-02
442  442   100    2  10.841110 0.13989750 15.976808 1.494073e-01
443  443   200    2  12.185132 0.17634422 12.985677 1.108466e-02
444  444   100    2  11.725024 0.19620303 14.752619 1.647376e-02
445  445   150    2  10.424559 0.13431450 15.859101 9.583998e-02
446  446    50    2  13.659154 0.13306314 10.587836 6.808986e-02
447  447    50    2  12.419585 0.20418862  9.334645 1.044015e-01
448  448   300    2  11.881443 0.13729227 11.444889 9.379064e-02
449  449   300    2  12.879144 0.13065487 10.720183 1.500653e-01
450  450   200    2  12.937661 0.14708555 10.839656 6.630441e-02
451  451    50    2  12.908001 0.16365562 11.379639 1.513871e-02
452  452   150    2  13.430864 0.09053210 10.025672 9.123475e-02
453  453   100    2  13.467791 0.13195471 10.394746 7.242559e-02
454  454   100    2  12.639473 0.18807921  9.415852 1.400652e-01
455  455   300    2  13.310614 0.12695489  8.819549 1.302529e-01
456  456   500    2  11.925181 0.12609769 15.420382 3.345084e-03
457  457   150    2  12.733785 0.10860592 12.526626 4.837593e-02
458  458   300    2  12.000675 0.16308789 13.883748 3.079774e-02
459  459   200    2  13.761266 0.12051272  9.778936 1.210011e-01
460  460   500    2  12.757527 0.21146906 11.112460 5.123596e-02
461  461   150    2  11.327956 0.16210091 14.758759 7.313675e-02
462  462   300    2  13.358227 0.14408346  9.349847 6.397503e-02
463  463   300    2   9.676474 0.14624366 18.239579 9.145914e-02
464  464    50    2  12.169002 0.12627791 12.162067 7.675215e-02
465  465   500    2  13.387247 0.13894524  9.830902 1.060054e-02
466  466   150    2  12.421249 0.11915877 10.846666 7.210464e-02
467  467   300    2  11.480357 0.09766541 15.083485 7.648190e-02
468  468    50    2  13.790188 0.07846380  9.092933 3.489497e-01
469  469   150    2  11.815067 0.18229380 14.519428 1.203262e-02
470  470   500    2  12.906547 0.07159903 12.172440 7.688240e-02
471  471   500    2  13.089399 0.11778409 10.628718 9.863989e-03
472  472   100    2  11.722574 0.18151736 14.169570 8.871994e-02
473  473   500    2  12.185882 0.20606868 12.309866 3.745809e-03
474  474   500    2  13.549510 0.11654635  9.115370 1.151648e-01
475  475   150    2  11.034649 0.15695231 15.536112 3.878003e-02
476  476   150    2  12.418635 0.12911479  9.684026 1.328658e-01
477  477   100    2  11.221275 0.24139513 15.360133 4.255150e-03
478  478   100    2  11.511454 0.16120212 14.473935 9.196790e-02
479  479   200    2  11.262261 0.16877165 15.428154 1.497783e-02
480  480    50    2  11.147542 0.17188983 15.123528 5.052100e-02
481  481   200    2  11.685107 0.17383181 13.829850 1.334686e-01
482  482   300    2   8.962907 0.14196219 19.079538 6.753333e-02
483  483   500    2  13.034376 0.06550950  9.792528 2.049136e-01
484  484    50    2  11.432297 0.13823487 14.369388 1.512563e-01
485  485    50    2   9.842222 0.16679043 18.133010 3.535611e-02
486  486   300    2  13.275134 0.15437299  9.446914 1.218791e-01
487  487   300    2  13.284247 0.11845023 10.189642 5.653035e-02
488  488   150    2  11.039813 0.12378573 15.892801 7.063878e-02
489  489   100    2  11.561073 0.10873969 14.805668 1.055169e-01
490  490   200    2  10.780498 0.17952223 15.559208 9.049904e-02
491  491    50    2  11.880116 0.18177093 11.655045 1.094455e-02
492  492   500    2  13.931624 0.12310230  8.894986 9.338345e-02
493  493   150    2  11.746532 0.18591925 12.841514 3.264330e-02
494  494   500    2  11.857066 0.14479467 14.469309 5.563016e-02
495  495   500    2  13.629623 0.11035705 10.537319 5.652980e-02
496  496   500    2  11.383051 0.12338903 15.331580 7.291749e-02
497  497    50    2  13.510073 0.13021968  9.452094 1.910377e-01
498  498    50    2  12.163412 0.18663984 11.976722 5.459312e-02
499  499   500    2   9.583474 0.16498505 18.490254 3.185684e-02
500  500    50    2  10.817031 0.17545759 14.473517 8.164346e-02</code></pre>
</div>
</div>
</section>
<section id="rf-grid" class="level1">
<h1>17.RF grid</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>best_rf_grid_tun <span class="ot">&lt;-</span> best_model<span class="sc">$</span>finalModel</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>best_rf_grid_tun</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(x = x, y = y, ntree = ..1, mtry = param$mtry) 
               Type of random forest: regression
                     Number of trees: 150
No. of variables tried at each split: 2

          Mean of squared residuals: 241.1348
                    % Var explained: -7.94</code></pre>
</div>
</div>
</section>
<section id="importancia-de-variables" class="level1">
<h1>18.Importancia de variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>var_import <span class="ot">&lt;-</span> <span class="fu">varImp</span>(best_rf_grid_tun, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>var_import <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variables =</span> <span class="fu">row.names</span>(var_import),</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">importance =</span> var_import<span class="sc">$</span>Overall)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_import)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   variables importance
1                        C.O   1990.050
2                         CI   3280.450
3                         HV   2952.159
4                  LS_Factor   3221.020
5                      MCARI   3330.054
6                       NDTI   2574.564
7    Relative_Slope_Position   2622.908
8                    Suelos_   2644.529
9  Topographic_Wetness_Index   4972.733
10              Valley_Depth   3229.637</code></pre>
</div>
</div>
</section>
<section id="se-grafican-para-entender-cúal-covariable-está-influyendo-más-en-el-modelo" class="level1">
<h1>19. Se grafican para entender cúal covariable está influyendo más en el modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> var_import <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(importance) <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variables, importance), <span class="at">y =</span> importance)) <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Variables"</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Importancia de variables Random forest "</span>) <span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="RF_Lim_Sup_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conjunto-datos-manteniendo-la-parte-espacial." class="level1">
<h1>20. Conjunto datos manteniendo la parte espacial.</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>train_sf <span class="ot">&lt;-</span>data_final_sf[index, ]</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>test_sf <span class="ot">&lt;-</span> data_final_sf[<span class="sc">-</span>index, ]</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> data_sf, <span class="fu">aes</span>(<span class="at">color =</span> Lim_sup), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> test_sf, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de Muestras"</span>, <span class="at">color =</span> <span class="st">"Valores"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="RF_Lim_Sup_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-grafica-importancia_variables" class="level1">
<h1>21. Guardar grafica Importancia_variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"Importancia_variables_RF.png"</span>,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> p,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados"</span>,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">18</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">14</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"cm"</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="predicción-y-visualización" class="level1">
<h1>Predicción y visualización</h1>
</section>
<section id="nombres-de-capas-variables-del-modelo" class="level1">
<h1>22. Nombres de capas = variables del modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>dataVARS <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"C.O"</span>,<span class="st">"CI"</span>, <span class="st">"HV"</span>, <span class="st">"MCARI"</span>, <span class="st">"LS_Factor"</span>, <span class="st">"NDTI"</span>, <span class="st">"Suelos_"</span>, </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a> <span class="st">"Relative_Slope_Position"</span>, <span class="st">"Topographic_Wetness_Index"</span> ,<span class="st">"Valley_Depth"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># En terra usamos 'subset' para quedarnos solo con las capas que necesitamos</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Asumiendo que tu objeto raster se llama 'raster' (o cámbiale el nombre)</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>r_predictores <span class="ot">&lt;-</span> <span class="fu">subset</span>(raster, dataVARS)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificación de seguridad (Debe salir T</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"¿Están todas las variables?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "¿Están todas las variables?"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">all</span>(dataVARS <span class="sc">%in%</span> <span class="fu">names</span>(r_predictores)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="aplicar-modelo-rf_grid" class="level1">
<h1>23. aplicar modelo rf_grid</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicción rápida (en memoria)</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>Limite_Sup <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">predict</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  r_predictores,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> best_model<span class="sc">$</span>finalModel,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Limite_Sup, <span class="at">main =</span> <span class="st">"Predicción Límite Superior Random Forest"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="RF_Lim_Sup_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-modelo-rf_grid" class="level1">
<h1>24. Guardar modelo rf_grid</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(Limite_Sup, <span class="st">"D:/Mapa final/Limite_Superior_RF.tif"</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
</div>
</section>
<section id="guardar-imagen-png-modelo-rf_grid" class="level1">
<h1>25. Guardar imagen png modelo rf_grid</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados/Limite_Superior_RF.png"</span>,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">3000</span>,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">2500</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">res =</span> <span class="dv">300</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  Limite_Sup,</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicción del Límite Superior del departamento de Meta y Vichada (Random Forest)"</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>
<section id="hacer-recorte-de-zona-de-estudio" class="level1">
<h1>26. Hacer recorte de Zona de estudio</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raster de predicción</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> Limite_Sup   <span class="co"># o rast("Limite_Superior_RF.tif")</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Polígono de la zona de interés</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>zona <span class="ot">&lt;-</span> <span class="fu">vect</span>(<span class="st">"D:/MAESTRIA/Trabajo_final/shp tesis/Altillanura_2.shp"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="reproyectar" class="level1">
<h1>27. Reproyectar</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>zona <span class="ot">&lt;-</span> <span class="fu">project</span>(zona, <span class="fu">crs</span>(r))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="cortar-zona-de-estudio" class="level1">
<h1>28. Cortar zona de estudio</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>r_crop <span class="ot">&lt;-</span> <span class="fu">crop</span>(r, zona)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>r_crop <span class="ot">&lt;-</span> <span class="fu">mask</span>(r_crop, zona)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="mapa-de-predicción" class="level1">
<h1>29. Mapa de predicción</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r_crop, <span class="at">main =</span> <span class="st">"Predicion Limite Superior (Random Forest)</span><span class="sc">\n</span><span class="st"> Altillanura Plana del Departamento del Meta"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="RF_Lim_Sup_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-mapa" class="level1">
<h1>30. Guardar mapa</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  r_crop,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/Mapa final/Lim_sup_Altillanura.tif"</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">overwrite =</span> <span class="cn">TRUE</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="guardar-mapa-como-imagen" class="level1">
<h1>31.Guardar mapa como imagen</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados/Limite_Superior_Altillanura_RF.png"</span>,</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">3000</span>,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">2500</span>,</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">res =</span> <span class="dv">300</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  r_crop,</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicion Limite Superior (Random Forest)</span><span class="sc">\n</span><span class="st"> Altillanura Plana del Departamento del Meta"</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>
<section id="validacion-cruzada-del-mapa-final" class="level1">
<h1>validacion cruzada del mapa final</h1>
</section>
<section id="se-extraen-los-puntos-donde-los-datos-de-entrenamiento-y-de-prueba-se-cruzan-en-el-mapa-predicho" class="level1">
<h1>32. Se extraen los puntos donde los datos de entrenamiento y de prueba se cruzan en el mapa predicho</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>train_extract <span class="ot">=</span> raster<span class="sc">::</span><span class="fu">extract</span>(<span class="at">x =</span> Limite_Sup, <span class="at">y =</span> train_sf, <span class="at">df =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>test_extract <span class="ot">=</span> raster<span class="sc">::</span><span class="fu">extract</span>(<span class="at">x =</span> Limite_Sup, <span class="at">y =</span> test_sf, <span class="at">df =</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>train_extract <span class="ot">&lt;-</span> train_extract[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>test_extract  <span class="ot">&lt;-</span> test_extract[, <span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="se-tabulan-los-valores-predichos-y-los-valores-de-limite-superior-reales-que-se-dividieron-en-el-set-de-entrenamiento-y-prueba" class="level1">
<h1>33. Se tabulan los valores predichos y los valores de limite superior reales que se dividieron en el set de entrenamiento y prueba</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>val_train_data <span class="ot">=</span> <span class="fu">cbind</span>(train[<span class="st">"Lim_sup"</span>], <span class="at">predicho =</span> train_extract)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>val_train_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(val_train_data)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>val_test_data <span class="ot">=</span> <span class="fu">cbind</span>(test[<span class="st">"Lim_sup"</span>], <span class="at">predicho =</span> test_extract)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>val_test_data  <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(val_test_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="se-obtienen-las-métricas-de-validación-para-el-set-de-entrenamiento" class="level1">
<h1>34. Se obtienen las métricas de validación para el set de entrenamiento</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>train.R2 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">R2</span>(val_train_data<span class="sc">$</span>Lim_sup, val_train_data<span class="sc">$</span>predicho),<span class="dv">3</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>train.RMSE <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">RMSE</span>(val_train_data<span class="sc">$</span>Lim_sup, val_train_data<span class="sc">$</span>predicho),<span class="dv">3</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>train.MAE <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">MAE</span>(val_train_data<span class="sc">$</span>Lim_sup, val_train_data<span class="sc">$</span>predicho),<span class="dv">4</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="se-obtienen-las-métricas-de-validación-para-el-set-de-prueba" class="level1">
<h1>35.#Se obtienen las métricas de validación para el set de prueba</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>test.R2 <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">R2</span>(val_test_data<span class="sc">$</span>Lim_sup,val_test_data<span class="sc">$</span>predicho),<span class="dv">3</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>test.RMSE <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">RMSE</span>(val_test_data<span class="sc">$</span>Lim_sup,val_test_data<span class="sc">$</span>predicho),<span class="dv">3</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>test.MAE <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">MAE</span>(val_test_data<span class="sc">$</span>Lim_sup,val_test_data<span class="sc">$</span>predicho),<span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="se-visualizan-las-métricas" class="level1">
<h1>36.Se visualizan las métricas</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>Train_metrics <span class="ot">=</span> <span class="fu">c</span>(<span class="at">R2 =</span> train.R2, <span class="at">RMSE =</span> train.RMSE, <span class="at">MAE =</span> train.MAE) <span class="co"># R2, RMSE, MAE</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>Test_metrics <span class="ot">=</span> <span class="fu">c</span>(<span class="at">R2 =</span> test.R2, <span class="at">RMSE =</span> test.RMSE, <span class="at">MAE =</span> test.MAE) <span class="co"># R2, RMSE, MAE</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Train_metrics)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    R2   RMSE    MAE 
0.7640 7.3240 4.7976 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Test_metrics)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   R2  RMSE   MAE 
0.845 8.358 5.064 </code></pre>
</div>
</div>
</section>
<section id="crear-un-ggplot-comparanda-los-valores-predichos-con-los-datos-de-entrenamiento-y-prueba" class="level1">
<h1>37. Crear un ggplot comparanda los valores predichos con los datos de entrenamiento y prueba</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Lim_sup, <span class="at">y =</span> predicho, <span class="at">color =</span> <span class="st">"Train"</span>), <span class="at">data =</span>val_train_data) <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> Lim_sup, <span class="at">y =</span> predicho, <span class="at">color =</span> <span class="st">"Test"</span>), <span class="at">data =</span> val_test_data)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="RF_Lim_Sup_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>